import{j as e}from"./ui-vendor-DMJGUSRC.js";import{r as o}from"./react-vendor-nf7bT_Uh.js";import{t as $,u as D,v as P,I as K,C as U}from"./index-DrqQ7fbC.js";import{B as N}from"./badge-BPHkP0Hu.js";const T="https://a.espncdn.com/i";function F(n,a=500){if(!n||n==="FA"||n==="BYE"||n==="TBD")return"";const i={JAX:"jac",LAR:"lar",LAC:"lac",WSH:"wsh",KC:"kc"}[n]||n.toLowerCase();return`${T}/teamlogos/nfl/500/${i}.png`}function I(n){return n?`${T}/headshots/nfl/players/full/${n}.png`:"https://a.espncdn.com/combiner/i?img=/i/headshots/nophoto.png&w=200&h=146"}function M({onSelectPlayer:n}){const[a,u]=o.useState(""),[i,_]=o.useState(""),[m,d]=o.useState([]),[b,p]=o.useState([]),[B,h]=o.useState(!1),[f,v]=o.useState(!1),[y,S]=o.useState(""),[x,O]=o.useState(!1),w=o.useCallback(async s=>{if(!s||s.length<2){p([]),h(!1);return}try{const t=await $(s,{type:"player",limit:5});p(t.suggestions||[]),h(!0)}catch(t){console.error("Autocomplete failed:",t),p([])}},[]),j=o.useCallback(async(s,t)=>{var r;if(!s||s.length<2){d([]);return}v(!0),S(""),h(!1);try{let l;if(x)try{l=await D(s,{type:"player",position:t,limit:50});const g=((r=l.results)==null?void 0:r.map(c=>{var E,k,C,R;return{id:c.entity_id,player_id:c.entity_id,name:c.title,position:((E=c.metadata)==null?void 0:E.position)||"",team:((k=c.metadata)==null?void 0:k.team)||"",status:((C=c.metadata)==null?void 0:C.status)||"active",jersey_number:((R=c.metadata)==null?void 0:R.number)||null}}))||[];d(g)}catch(g){console.warn("New search failed, falling back to old search:",g),l=await P(s,t),d(l.data||[])}else l=await P(s,t),d(l.data||[])}catch(l){S("Failed to search players. Please try again."),console.error("Search failed:",l)}finally{v(!1)}},[x]);o.useEffect(()=>{const s=setTimeout(()=>{a.length>=2&&i?(x&&w(a),j(a,i)):(d([]),p([]),h(!1))},150);return()=>clearTimeout(s)},[a,i,x,j,w]);const L=s=>{s.key==="Enter"&&a.length>=2&&j(a,i)},A=(s,t)=>{if(!t)return s;const r=s.split(new RegExp(`(${t})`,"gi"));return e.jsx(e.Fragment,{children:r.map((l,g)=>l.toLowerCase()===t.toLowerCase()?e.jsx("span",{className:"bg-yellow-200 dark:bg-yellow-800 font-semibold",children:l},g):l)})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 relative",children:[e.jsxs("div",{className:"text-sm mb-2",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:"🔍 Search Players:"}),e.jsx("span",{className:"text-muted-foreground ml-1",children:"Select position and search by name"}),x&&e.jsx("span",{className:"ml-2 text-xs text-green-600 dark:text-green-400",children:"(⚡ New Search Engine)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:i,onChange:s=>_(s.target.value),className:"px-3 py-2 border rounded-md bg-background min-w-[120px]",disabled:f,children:[e.jsx("option",{value:"",children:"Select Position"}),e.jsx("option",{value:"QB",children:"QB"}),e.jsx("option",{value:"RB",children:"RB"}),e.jsx("option",{value:"WR",children:"WR"}),e.jsx("option",{value:"TE",children:"TE"}),e.jsx("option",{value:"K",children:"K"}),e.jsx("option",{value:"DEF",children:"DEF"})]}),e.jsx(K,{placeholder:"Search players by name (min 2 characters)...",value:a,onChange:s=>u(s.target.value),onKeyPress:L,disabled:f,className:"flex-1"})]}),!i&&a.length>=2&&e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:"⚠️ Please select a position first"}),a.length>0&&a.length<2&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Type at least 2 characters to search"}),f&&e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin",children:"⏳"})," Searching..."]}),B&&b.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg",children:e.jsxs("div",{className:"p-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"💡 Quick suggestions:"}),b.map((s,t)=>{var r;return e.jsxs("div",{className:"px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded cursor-pointer text-sm",onClick:()=>{u(s.suggestion),h(!1),j(s.suggestion,i)},children:[s.suggestion,((r=s.metadata)==null?void 0:r.position)&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",s.metadata.position,")"]})]},t)})]})})]}),y&&e.jsx("div",{className:"text-sm text-red-600 dark:text-red-400 p-3 bg-red-50 dark:bg-red-950 rounded-md",children:y}),m.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:[m.length," player",m.length!==1?"s":""," found"]}),e.jsx("div",{className:"grid gap-2 max-h-96 overflow-y-auto",children:m.map((s,t)=>e.jsx(U,{className:"p-3 cursor-pointer hover:bg-accent transition-colors hover:shadow-md",onClick:()=>{try{console.error("🔍 DEBUGGING onSelectPlayer:",typeof n,n.toString()),console.log("PLAYER CLICKED:",s),alert(`Adding ${s.name} to roster`),console.log("About to call onSelectPlayer"),n(s),console.log("onSelectPlayer returned successfully"),u(""),d([])}catch(r){console.error("ERROR in click handler:",r),alert(`ERROR: ${r}`)}},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("img",{src:I(s.player_id||s.nfl_id),alt:s.name,className:"w-12 h-12 rounded-full object-cover border-2 border-gray-200 dark:border-gray-700",onError:r=>{r.currentTarget.src="https://a.espncdn.com/combiner/i?img=/i/headshots/nophoto.png&w=200&h=146"}}),s.team&&e.jsx("img",{src:F(s.team),alt:s.team,className:"w-7 h-7 object-contain",onError:r=>r.currentTarget.style.display="none"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:A(s.name,a)}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(N,{variant:"outline",className:"text-xs",children:s.position}),e.jsx(N,{variant:"outline",className:"text-xs",children:s.team}),s.status&&s.status.toUpperCase()==="ACTIVE"&&e.jsx(N,{className:"text-xs bg-green-600 text-white",children:"Active"})]})]})]}),s.jersey_number&&e.jsxs("div",{className:"text-xl font-bold text-muted-foreground ml-4",children:["#",s.jersey_number]})]})},s.id||t))})]}),!f&&m.length===0&&a.length>=2&&e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["No ",i,' players found for "',a,'"']}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Try:"}),e.jsxs("ul",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx("li",{children:"• Checking your spelling"}),e.jsx("li",{children:"• Using a different name variation"}),e.jsx("li",{children:"• Searching by first or last name only"}),e.jsx("li",{children:"• Selecting a different position"})]})]})]})}const Y=Object.freeze(Object.defineProperty({__proto__:null,PlayerSearch:M},Symbol.toStringTag,{value:"Module"}));export{M as P,F as a,Y as b,I as g};
