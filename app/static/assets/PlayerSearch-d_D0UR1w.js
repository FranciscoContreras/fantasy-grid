import{j as e}from"./ui-vendor-DMJGUSRC.js";import{r as n}from"./react-vendor-nf7bT_Uh.js";import{t as m,u as I,v as L,w as U,x as T,I as K}from"./index-Dk0w3qhX.js";import{g as O,a as V}from"./images-DPtUUTlJ.js";const _=n.forwardRef(({className:a,...t},r)=>e.jsx("div",{ref:r,className:m("rounded-lg border bg-card text-card-foreground shadow-sm",a),...t}));_.displayName="Card";const $=n.forwardRef(({className:a,...t},r)=>e.jsx("div",{ref:r,className:m("flex flex-col space-y-1.5 p-6",a),...t}));$.displayName="CardHeader";const G=n.forwardRef(({className:a,...t},r)=>e.jsx("h3",{ref:r,className:m("text-2xl font-semibold leading-none tracking-tight",a),...t}));G.displayName="CardTitle";const z=n.forwardRef(({className:a,...t},r)=>e.jsx("p",{ref:r,className:m("text-sm text-muted-foreground",a),...t}));z.displayName="CardDescription";const H=n.forwardRef(({className:a,...t},r)=>e.jsx("div",{ref:r,className:m("p-6 pt-0",a),...t}));H.displayName="CardContent";const M=n.forwardRef(({className:a,...t},r)=>e.jsx("div",{ref:r,className:m("flex items-center p-6 pt-0",a),...t}));M.displayName="CardFooter";const W=I("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function N({className:a,variant:t,...r}){return e.jsx("div",{className:m(W({variant:t}),a),...r})}function Y({onSelectPlayer:a}){const[t,r]=n.useState(""),[d,A]=n.useState(""),[g,x]=n.useState([]),[v,p]=n.useState([]),[B,u]=n.useState(!1),[j,y]=n.useState(!1),[w,S]=n.useState(""),[h,J]=n.useState(!1),C=n.useCallback(async s=>{if(!s||s.length<2){p([]),u(!1);return}try{const o=await L(s,{type:"player",limit:5});p(o.suggestions||[]),u(!0)}catch(o){console.error("Autocomplete failed:",o),p([])}},[]),b=n.useCallback(async(s,o)=>{var l;if(!s||s.length<2){x([]);return}y(!0),S(""),u(!1);try{let i;if(h)try{i=await U(s,{type:"player",position:o,limit:50});const f=((l=i.results)==null?void 0:l.map(c=>{var k,R,E,P;return{id:c.entity_id,player_id:c.entity_id,name:c.title,position:((k=c.metadata)==null?void 0:k.position)||"",team:((R=c.metadata)==null?void 0:R.team)||"",status:((E=c.metadata)==null?void 0:E.status)||"active",jersey_number:((P=c.metadata)==null?void 0:P.number)||null}}))||[];x(f)}catch(f){console.warn("New search failed, falling back to old search:",f),i=await T(s,o),x(i.data||[])}else i=await T(s,o),x(i.data||[])}catch(i){S("Failed to search players. Please try again."),console.error("Search failed:",i)}finally{y(!1)}},[h]);n.useEffect(()=>{const s=setTimeout(()=>{t.length>=2&&d?(h&&C(t),b(t,d)):(x([]),p([]),u(!1))},150);return()=>clearTimeout(s)},[t,d,h,b,C]);const D=s=>{s.key==="Enter"&&t.length>=2&&b(t,d)},F=(s,o)=>{if(!o)return s;const l=s.split(new RegExp(`(${o})`,"gi"));return e.jsx(e.Fragment,{children:l.map((i,f)=>i.toLowerCase()===o.toLowerCase()?e.jsx("span",{className:"bg-yellow-200 dark:bg-yellow-800 font-semibold",children:i},f):i)})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 relative",children:[e.jsxs("div",{className:"text-sm mb-2",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:"🔍 Search Players:"}),e.jsx("span",{className:"text-muted-foreground ml-1",children:"Select position and search by name"}),h&&e.jsx("span",{className:"ml-2 text-xs text-green-600 dark:text-green-400",children:"(⚡ New Search Engine)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:d,onChange:s=>A(s.target.value),className:"px-3 py-2 border rounded-md bg-background min-w-[120px]",disabled:j,children:[e.jsx("option",{value:"",children:"Select Position"}),e.jsx("option",{value:"QB",children:"QB"}),e.jsx("option",{value:"RB",children:"RB"}),e.jsx("option",{value:"WR",children:"WR"}),e.jsx("option",{value:"TE",children:"TE"}),e.jsx("option",{value:"K",children:"K"}),e.jsx("option",{value:"DEF",children:"DEF"})]}),e.jsx(K,{placeholder:"Search players by name (min 2 characters)...",value:t,onChange:s=>r(s.target.value),onKeyPress:D,disabled:j,className:"flex-1"})]}),!d&&t.length>=2&&e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:"⚠️ Please select a position first"}),t.length>0&&t.length<2&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Type at least 2 characters to search"}),j&&e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin",children:"⏳"})," Searching..."]}),B&&v.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg",children:e.jsxs("div",{className:"p-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"💡 Quick suggestions:"}),v.map((s,o)=>{var l;return e.jsxs("div",{className:"px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded cursor-pointer text-sm",onClick:()=>{r(s.suggestion),u(!1),b(s.suggestion,d)},children:[s.suggestion,((l=s.metadata)==null?void 0:l.position)&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",s.metadata.position,")"]})]},o)})]})})]}),w&&e.jsx("div",{className:"text-sm text-red-600 dark:text-red-400 p-3 bg-red-50 dark:bg-red-950 rounded-md",children:w}),g.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:[g.length," player",g.length!==1?"s":""," found"]}),e.jsx("div",{className:"grid gap-2 max-h-96 overflow-y-auto",children:g.map((s,o)=>e.jsx(_,{className:"p-3 cursor-pointer hover:bg-accent transition-colors hover:shadow-md",onClick:()=>{try{console.error("🔍 DEBUGGING onSelectPlayer:",typeof a,a.toString()),console.log("PLAYER CLICKED:",s),alert(`Adding ${s.name} to roster`),console.log("About to call onSelectPlayer"),a(s),console.log("onSelectPlayer returned successfully"),r(""),x([])}catch(l){console.error("ERROR in click handler:",l),alert(`ERROR: ${l}`)}},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("img",{src:O(s.player_id||s.nfl_id),alt:s.name,className:"w-12 h-12 rounded-full object-cover border-2 border-gray-200 dark:border-gray-700",onError:l=>{l.currentTarget.src="https://a.espncdn.com/combiner/i?img=/i/headshots/nophoto.png&w=200&h=146"}}),s.team&&e.jsx("img",{src:V(s.team),alt:s.team,className:"w-7 h-7 object-contain",onError:l=>l.currentTarget.style.display="none"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:F(s.name,t)}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(N,{variant:"outline",className:"text-xs",children:s.position}),e.jsx(N,{variant:"outline",className:"text-xs",children:s.team}),s.status&&s.status.toUpperCase()==="ACTIVE"&&e.jsx(N,{className:"text-xs bg-green-600 text-white",children:"Active"})]})]})]}),s.jersey_number&&e.jsxs("div",{className:"text-xl font-bold text-muted-foreground ml-4",children:["#",s.jersey_number]})]})},s.id||o))})]}),!j&&g.length===0&&t.length>=2&&e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["No ",d,' players found for "',t,'"']}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Try:"}),e.jsxs("ul",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx("li",{children:"• Checking your spelling"}),e.jsx("li",{children:"• Using a different name variation"}),e.jsx("li",{children:"• Searching by first or last name only"}),e.jsx("li",{children:"• Selecting a different position"})]})]})]})}const ee=Object.freeze(Object.defineProperty({__proto__:null,PlayerSearch:Y},Symbol.toStringTag,{value:"Module"}));export{N as B,_ as C,Y as P,H as a,$ as b,G as c,ee as d};
