import{j as e,C as ve,Z as we,T as de,a as ke,b as Se,A as oe,c as _e}from"./ui-vendor-DMJGUSRC.js";import{r as n}from"./react-vendor-nf7bT_Uh.js";import{B as p,g as Re,b as Ce,c as Ae,d as xe,e as Ee,f as Le,h as Pe,i as Te,j as Fe,k as Me,I as J,l as ze,m as Ie,n as De,o as We,p as Oe}from"./index-BKB8gddV.js";import{C as N,a as v,b as L,c as P,B as k,g as te,d as X,P as $e}from"./PlayerSearch-DOCyv_4l.js";function Ye({week:s,season:a,onWeekChange:r}){const h=()=>{s>1&&r(s-1)},i=()=>{s<18&&r(s+1)};return e.jsxs("div",{className:"flex items-center justify-between bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs(p,{variant:"outline",onClick:h,disabled:s<=1,className:"px-6 font-bold",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"PREV WEEK"]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-black tracking-tight",children:["WEEK ",s]}),e.jsxs("div",{className:"text-sm text-gray-500 uppercase tracking-wider font-semibold mt-1",children:[a," Season"]})]}),e.jsxs(p,{variant:"outline",onClick:i,disabled:s>=18,className:"px-6 font-bold",children:["NEXT WEEK",e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})}function Be({score:s}){const a=()=>s>=85?"bg-black":s>=70?"bg-gray-600":"bg-gray-400",r=()=>s>=85?"EXCELLENT":s>=70?"GOOD":s>=50?"FAIR":"WEAK";return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 uppercase tracking-wider font-semibold mb-1",children:"Lineup Confidence"}),e.jsxs("div",{className:"text-5xl font-black tracking-tight",children:[s,"%"]})]}),e.jsx("div",{className:`px-6 py-3 rounded-full text-white font-black text-sm uppercase tracking-wider ${a()}`,children:r()})]}),e.jsx("div",{className:"relative w-full h-4 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${a()} transition-all duration-500`,style:{width:`${s}%`}})}),e.jsx("p",{className:"text-xs text-gray-500 mt-3 text-center uppercase tracking-wider font-semibold",children:"Based on matchups, injuries, and analytics"})]})}function le({player:s,recommendation:a,grade:r,confidence:h,matchup_score:i,weather_score:c,injury_score:S,advanced_stats_score:y,projected_points:w,projected_range:f,reasons:x}){const C=a==="START"?{container:"bg-black text-white border-black",badge:"bg-white text-black",icon:""}:a==="CONSIDER"?{container:"bg-gray-200 text-black border-gray-300",badge:"bg-gray-600 text-white",icon:"?"}:{container:"bg-gray-100 text-gray-500 border-gray-200 opacity-60",badge:"bg-gray-400 text-white",icon:"ï¿½"};return e.jsxs("div",{className:`relative border rounded-2xl p-6 hover:scale-105 transition-transform ${C.container}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xl font-black tracking-tight mb-1",children:s.name}),e.jsxs("div",{className:"text-sm uppercase tracking-wider font-semibold opacity-70",children:[s.position," ï¿½ ",s.team]})]}),e.jsx("div",{className:"text-5xl font-black opacity-50",children:r})]}),e.jsxs("div",{className:`inline-flex items-center gap-2 px-5 py-2 rounded-full font-black text-sm uppercase tracking-wider mb-6 ${C.badge}`,children:[e.jsx("span",{className:"text-lg",children:C.icon}),a]}),e.jsxs("div",{className:"mb-6 pb-6 border-b border-current opacity-30",children:[e.jsx("div",{className:"text-xs uppercase tracking-wider font-semibold opacity-70 mb-1",children:"Projected Points"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-black",children:w.toFixed(1)}),e.jsxs("span",{className:"text-sm opacity-50",children:["(",f[0].toFixed(1)," - ",f[1].toFixed(1),")"]})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx(ee,{label:"Matchup",score:i}),e.jsx(ee,{label:"Weather",score:c}),e.jsx(ee,{label:"Health",score:S}),e.jsx(ee,{label:"Stats",score:y})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"text-xs uppercase tracking-wider font-semibold opacity-70 mb-2",children:["Confidence: ",h,"%"]}),e.jsx("div",{className:"w-full bg-current opacity-20 rounded-full h-2",children:e.jsx("div",{className:"bg-current opacity-100 h-full rounded-full transition-all",style:{width:`${h}%`}})})]}),x.length>0&&e.jsx("div",{className:"text-xs opacity-70 space-y-1",children:x.map((l,g)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{children:'"'}),e.jsx("span",{children:l})]},g))})]})}function ee({label:s,score:a}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs uppercase tracking-wider font-semibold opacity-70",children:s}),e.jsxs("span",{className:"text-xs font-bold",children:[a,"/100"]})]}),e.jsx("div",{className:"w-full bg-current opacity-20 rounded-full h-1.5",children:e.jsx("div",{className:"bg-current opacity-100 h-full rounded-full transition-all",style:{width:`${a}%`}})})]})}function He({starters:s,bench:a}){const r=s.filter(i=>i.recommendation==="START"),h=s.filter(i=>i.recommendation==="CONSIDER");return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-3xl font-black tracking-tight mb-2",children:"STARTERS"}),e.jsx("p",{className:"text-sm text-gray-500 uppercase tracking-wider font-semibold",children:"Recommended for your lineup"})]}),r.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-3 h-3 bg-black rounded-full"}),e.jsxs("h3",{className:"text-lg font-black uppercase tracking-tight",children:["START (",r.length,")"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:r.map((i,c)=>e.jsx(le,{...i},c))})]}),h.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-600 rounded-full"}),e.jsxs("h3",{className:"text-lg font-black uppercase tracking-tight",children:["CONSIDER (",h.length,")"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:h.map((i,c)=>e.jsx(le,{...i},c))})]}),s.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("p",{className:"text-lg font-semibold",children:"No starters recommended"}),e.jsx("p",{className:"text-sm mt-2",children:"Add players to your roster to see recommendations"})]})]}),a.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-3xl font-black tracking-tight mb-2",children:"BENCH"}),e.jsx("p",{className:"text-sm text-gray-500 uppercase tracking-wider font-semibold",children:"Sit these players this week"})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-400 rounded-full"}),e.jsxs("h3",{className:"text-lg font-black uppercase tracking-tight",children:["BENCH (",a.length,")"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:a.map((i,c)=>e.jsx(le,{...i},c))})]})]})}function Ue({rosterId:s}){const[a,r]=n.useState(!1),[h,i]=n.useState(""),[c,S]=n.useState(null),[y,w]=n.useState(5),[f]=n.useState(2024);n.useEffect(()=>{x()},[s,y]);const x=async()=>{r(!0),i("");try{const l=localStorage.getItem("auth_token"),g=await fetch(`/api/rosters/${s}/weekly-lineup?week=${y}&season=${f}`,{headers:{Authorization:`Bearer ${l}`}});if(!g.ok)throw new Error("Failed to load weekly lineup");const E=await g.json();S(E.data)}catch(l){console.error("Error loading weekly lineup:",l),i("Failed to load weekly lineup. Please try again.")}finally{r(!1)}},b=l=>{w(l)},C=async()=>{r(!0),i("");try{const l=localStorage.getItem("auth_token");if(!(await fetch(`/api/rosters/${s}/analyze`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({week:y,season:f})})).ok)throw new Error("Failed to analyze roster");await x()}catch(l){console.error("Error analyzing roster:",l),i("Failed to analyze roster. Please try again.")}finally{r(!1)}};return a&&!c?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-black border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-gray-600",children:"Loading weekly lineup..."})]})}):h?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-4",children:h}),e.jsx(p,{onClick:x,variant:"outline",children:"Try Again"})]}):c?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ye,{week:c.week,season:c.season,onWeekChange:b}),e.jsx(Be,{score:c.overall_confidence}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(p,{onClick:C,disabled:a,className:"bg-black text-white hover:bg-gray-900 font-bold",children:a?"ANALYZING...":"ANALYZE ALL PLAYERS"}),e.jsx(p,{variant:"outline",className:"font-bold",children:"COMPARE PLAYERS"}),e.jsx(p,{variant:"outline",className:"font-bold",children:"TRADE ANALYZER"})]}),e.jsx(He,{starters:c.starters,bench:c.bench}),c.starters.length===0&&c.bench.length===0&&e.jsx("div",{className:"text-center py-20 bg-gray-50 rounded-xl border border-gray-200",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("div",{className:"text-6xl mb-6",children:"=ï¿½"}),e.jsx("h3",{className:"text-2xl font-black mb-3",children:"NO PLAYERS IN ROSTER"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Add players to your roster to see weekly start/sit recommendations."}),e.jsx(p,{className:"bg-black text-white hover:bg-gray-900 font-bold",children:"ADD PLAYERS"})]})})]}):null}const se=[{slot:"QB",label:"QB",isStarter:!0},{slot:"RB1",label:"RB",isStarter:!0},{slot:"RB2",label:"RB",isStarter:!0},{slot:"WR1",label:"WR",isStarter:!0},{slot:"WR2",label:"WR",isStarter:!0},{slot:"WR3",label:"WR",isStarter:!0},{slot:"TE",label:"TE",isStarter:!0},{slot:"FLEX",label:"FLEX",isStarter:!0},{slot:"K",label:"K",isStarter:!0},{slot:"DEF",label:"DEF",isStarter:!0}],me={HEALTHY:"bg-green-500",PROBABLE:"bg-blue-500",QUESTIONABLE:"bg-yellow-500",DOUBTFUL:"bg-orange-500",OUT:"bg-red-500"},he={START:{border:"border-green-500",bg:"bg-green-50 dark:bg-green-950/20",text:"text-green-700 dark:text-green-400"},SIT:{border:"border-red-500",bg:"bg-red-50 dark:bg-red-950/20",text:"text-red-700 dark:text-red-400"},CONSIDER:{border:"border-yellow-500",bg:"bg-yellow-50 dark:bg-yellow-950/20",text:"text-yellow-700 dark:text-yellow-400"}};function Ge({rosterId:s,onRosterUpdate:a}){var I;const[r,h]=n.useState(null),[i,c]=n.useState(new Map),[S,y]=n.useState(!0),[w,f]=n.useState(!1),[x,b]=n.useState(""),[C,l]=n.useState(null),[g,E]=n.useState("weekly");n.useEffect(()=>{D()},[s]);const D=async()=>{try{y(!0);const d=await Re(s);h(d.data)}catch(d){b("Failed to load roster"),console.error(d)}finally{y(!1)}},Z=async()=>{try{f(!0),b(""),await Ce(s),await D()}catch(d){b("Failed to analyze roster"),console.error(d)}finally{f(!1)}},Y=d=>{var u;return(u=r==null?void 0:r.players)==null?void 0:u.find(o=>o.roster_slot===d)},B=()=>{var o;const d=((o=r==null?void 0:r.players)==null?void 0:o.filter(j=>se.some(A=>A.isStarter&&A.slot===j.roster_slot)))||[];if(d.length===0)return 0;const u=d.reduce((j,A)=>{const U=i.get(A.id);return j+((U==null?void 0:U.projected_points)||0)},0);return Math.round(u/d.length*5)},W=()=>{var u;return(((u=r==null?void 0:r.players)==null?void 0:u.filter(o=>se.some(j=>j.isStarter&&j.slot===o.roster_slot)))||[]).reduce((o,j)=>{const A=i.get(j.id);return o+((A==null?void 0:A.projected_points)||0)},0)},O=()=>{var u;const d=((u=r==null?void 0:r.players)==null?void 0:u.filter(o=>se.some(j=>j.isStarter&&j.slot===o.roster_slot)))||[];return{start:d.filter(o=>{const j=i.get(o.id);return(j==null?void 0:j.recommendation)==="START"}).length,sit:d.filter(o=>{const j=i.get(o.id);return(j==null?void 0:j.recommendation)==="SIT"}).length,consider:d.filter(o=>{const j=i.get(o.id);return(j==null?void 0:j.recommendation)==="CONSIDER"}).length}},H=()=>{var d;return((d=r==null?void 0:r.players)==null?void 0:d.filter(u=>u.injury_status!=="HEALTHY").length)||0};if(S)return e.jsx(N,{children:e.jsx(v,{className:"py-8",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Loading roster..."})})});if(!r)return e.jsx(N,{children:e.jsx(v,{className:"py-8",children:e.jsx("p",{className:"text-center text-red-600",children:"Failed to load roster"})})});const m=B(),T=W(),R=O(),F=H(),z=((I=r.players)==null?void 0:I.filter(d=>d.roster_slot==="BENCH"))||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(N,{children:[e.jsx(L,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-2xl",children:r.name}),r.league_name&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[r.league_name," â€¢ ",r.scoring_type]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex gap-2 border rounded-lg p-1",children:[e.jsx(p,{variant:g==="weekly"?"default":"ghost",size:"sm",onClick:()=>E("weekly"),className:"px-4 font-bold",children:"WEEKLY"}),e.jsx(p,{variant:g==="classic"?"default":"ghost",size:"sm",onClick:()=>E("classic"),className:"px-4 font-bold",children:"CLASSIC"})]}),e.jsx(p,{onClick:Z,disabled:w,size:"lg",className:"min-w-40",children:w?e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"mr-2 h-4 w-4 animate-spin"}),"Analyzing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Analyze Roster"]})})]})]})}),e.jsx(v,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950/20 dark:to-blue-900/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Roster Strength"}),e.jsx(de,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs("p",{className:"text-3xl font-bold text-blue-700 dark:text-blue-400",children:[m,e.jsx("span",{className:"text-lg text-muted-foreground",children:"/100"})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950/20 dark:to-green-900/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Projected Points"}),e.jsx(ke,{className:"h-4 w-4 text-green-600"})]}),e.jsx("p",{className:"text-3xl font-bold text-green-700 dark:text-green-400",children:T.toFixed(1)})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Recommendations"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:R.start}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Start"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:R.consider}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Consider"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:R.sit}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sit"})]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Injury Report"}),e.jsx(Se,{className:"h-4 w-4 text-orange-600"})]}),F>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-3xl font-bold text-orange-700 dark:text-orange-400",children:F}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Players injured"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-2xl font-bold text-green-700 dark:text-green-400",children:"All Healthy"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"âœ“ No concerns"})]})]})]})})]}),x&&e.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-950 text-red-600 dark:text-red-400 rounded-md text-sm",children:x}),g==="weekly"?e.jsx(Ue,{rosterId:s}):e.jsxs(e.Fragment,{children:[e.jsxs(N,{children:[e.jsx(L,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5"}),"Starting Lineup"]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-3",children:se.map(d=>{const u=Y(d.slot),o=u?i.get(u.id):void 0,j=o!=null&&o.recommendation?he[o.recommendation]:{border:"border-gray-200",bg:""};return e.jsx("div",{className:`flex items-center justify-between p-4 border-2 rounded-lg transition-all ${j.border} ${j.bg}`,children:e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-16 text-center",children:e.jsx(k,{variant:"outline",className:"font-bold",children:d.label})}),u?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:te(u.player_id),alt:u.player_name,className:"w-12 h-12 rounded-full object-cover border-2 border-gray-200 dark:border-gray-700",onError:A=>{A.currentTarget.src="https://a.espncdn.com/combiner/i?img=/i/headshots/nophoto.png&w=200&h=146"}}),u.team&&e.jsx("img",{src:X(u.team),alt:u.team,className:"w-8 h-8 object-contain",onError:A=>A.currentTarget.style.display="none"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold",children:u.player_name}),e.jsx(k,{variant:"outline",className:"text-xs",children:u.position}),e.jsx(k,{variant:"outline",className:"text-xs",children:u.team}),u.injury_status!=="HEALTHY"&&e.jsx(k,{className:`text-xs text-white ${me[u.injury_status]}`,children:u.injury_status})]}),o&&e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm",children:[o.opponent_team&&e.jsxs("span",{className:"text-muted-foreground",children:["vs ",o.opponent_team]}),o.projected_points!==void 0&&e.jsxs("span",{className:"font-semibold text-green-700 dark:text-green-400",children:[o.projected_points.toFixed(1)," pts"]}),o.matchup_score!==void 0&&e.jsxs("span",{className:"text-muted-foreground",children:["Matchup: ",o.matchup_score,"/100"]}),o.ai_grade&&e.jsxs(k,{variant:"outline",className:"text-xs",children:["Grade: ",o.ai_grade]})]})]}),(o==null?void 0:o.recommendation)&&e.jsx(k,{className:`${he[o.recommendation].text} font-bold`,children:o.recommendation}),e.jsx("div",{className:"flex gap-2",children:e.jsx(p,{size:"sm",variant:"outline",children:e.jsx(oe,{className:"h-4 w-4"})})})]}):e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Empty slot"}),e.jsx(p,{size:"sm",onClick:()=>l(d.slot),className:"mt-2",children:"Add Player"})]})]})},d.slot)})})})]}),z.length>0&&e.jsxs(N,{children:[e.jsx(L,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5"}),"Bench (",z.length,")"]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-2",children:z.map(d=>{const u=i.get(d.id);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-accent transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("img",{src:te(d.player_id),alt:d.player_name,className:"w-10 h-10 rounded-full object-cover border border-gray-200 dark:border-gray-700",onError:o=>{o.currentTarget.src="https://a.espncdn.com/combiner/i?img=/i/headshots/nophoto.png&w=200&h=146"}}),d.team&&e.jsx("img",{src:X(d.team),alt:d.team,className:"w-6 h-6 object-contain",onError:o=>o.currentTarget.style.display="none"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium text-sm",children:d.player_name}),e.jsx(k,{variant:"outline",className:"text-xs",children:d.position}),d.injury_status!=="HEALTHY"&&e.jsx(k,{className:`text-xs text-white ${me[d.injury_status]}`,children:d.injury_status})]}),u&&u.projected_points!==void 0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Projected: ",u.projected_points.toFixed(1)," pts"]})]})]}),e.jsx(p,{size:"sm",variant:"ghost",children:e.jsx(oe,{className:"h-4 w-4"})})]},d.id)})})})]}),C&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 p-6 rounded-lg max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Add Player to ",C]}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>l(null),children:"âœ•"})]}),e.jsx($e,{onSelectPlayer:d=>{l(null)}})]})})]})]})}function Ke({playerId:s,playerName:a,onClose:r}){var C;const[h,i]=n.useState(!0),[c,S]=n.useState(null),[y,w]=n.useState("");n.useEffect(()=>{f()},[s]);const f=async()=>{try{i(!0);const l=await Ae(s);S(l.data)}catch(l){w("Failed to load player details"),console.error(l)}finally{i(!1)}},x=((C=c==null?void 0:c.player)==null?void 0:C.data)||(c==null?void 0:c.player),b=(c==null?void 0:c.recent_games)||[];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:r,children:e.jsxs("div",{className:"bg-background rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto m-4",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-background border-b p-4 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:a}),e.jsx(p,{variant:"outline",size:"sm",onClick:r,children:"Close"})]}),e.jsxs("div",{className:"p-6",children:[h&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading player details..."})}),y&&e.jsx("div",{className:"bg-red-50 dark:bg-red-950 text-red-600 dark:text-red-400 p-4 rounded-md",children:y}),!h&&!y&&x&&e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"mb-6",children:e.jsx(v,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:te(x.nfl_id),alt:a,className:"w-32 h-32 object-cover rounded-lg border-2 border-gray-200 dark:border-gray-700",onError:l=>{l.currentTarget.src="https://a.espncdn.com/combiner/i?img=/i/headshots/nophoto.png&w=200&h=146"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(k,{variant:"outline",className:"text-lg",children:x.position}),x.jersey_number&&e.jsxs(k,{variant:"outline",className:"text-lg",children:["#",x.jersey_number]}),x.team_id&&e.jsx("img",{src:X(x.team),alt:x.team,className:"w-8 h-8 object-contain",onError:l=>l.currentTarget.style.display="none"}),e.jsx(k,{className:x.status==="active"?"bg-green-600":"bg-gray-600",children:x.status})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[x.height_inches&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Height"}),e.jsxs("p",{className:"font-semibold",children:[Math.floor(x.height_inches/12),"'",x.height_inches%12,'"']})]}),x.weight_pounds&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Weight"}),e.jsxs("p",{className:"font-semibold",children:[x.weight_pounds," lbs"]})]}),x.team&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Team"}),e.jsx("p",{className:"font-semibold",children:x.team})]}),x.nfl_id&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"NFL ID"}),e.jsx("p",{className:"font-semibold",children:x.nfl_id})]})]})]})]})})}),e.jsxs(N,{children:[e.jsx(L,{children:e.jsxs(P,{children:["Last ",b.length," Games"]})}),e.jsx(v,{children:b.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No recent game data available"}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-2 text-sm font-semibold text-muted-foreground pb-2 border-b",children:[e.jsx("div",{children:"Week"}),e.jsx("div",{children:"Opp"}),e.jsx("div",{className:"text-right",children:"Yds"}),e.jsx("div",{className:"text-right",children:"TD"}),e.jsx("div",{className:"text-right",children:"Rec"}),e.jsx("div",{className:"text-right",children:"Pts"})]}),b.map((l,g)=>e.jsxs("div",{className:"grid grid-cols-6 gap-2 text-sm py-2 border-b border-gray-100 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-900",children:[e.jsx("div",{children:l.week||l.game_week||"-"}),e.jsx("div",{className:"font-semibold",children:l.opponent_team||l.opponent||"-"}),e.jsx("div",{className:"text-right",children:l.yards||l.passing_yards||l.rushing_yards||l.receiving_yards||0}),e.jsx("div",{className:"text-right",children:l.touchdowns||l.passing_tds||l.rushing_tds||l.receiving_tds||0}),e.jsx("div",{className:"text-right",children:l.receptions||l.targets||"-"}),e.jsx("div",{className:"text-right font-semibold",children:l.fantasy_points?l.fantasy_points.toFixed(1):"-"})]},g)),b.length>0&&e.jsxs("div",{className:"grid grid-cols-6 gap-2 text-sm py-2 font-bold bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"col-span-2",children:"Average"}),e.jsx("div",{className:"text-right",children:(b.reduce((l,g)=>l+(g.yards||g.passing_yards||g.rushing_yards||g.receiving_yards||0),0)/b.length).toFixed(1)}),e.jsx("div",{className:"text-right",children:(b.reduce((l,g)=>l+(g.touchdowns||g.passing_tds||g.rushing_tds||g.receiving_tds||0),0)/b.length).toFixed(1)}),e.jsx("div",{className:"text-right",children:"-"}),e.jsx("div",{className:"text-right",children:b.some(l=>l.fantasy_points!==void 0)?(b.reduce((l,g)=>l+(g.fantasy_points||0),0)/b.length).toFixed(1):"-"})]})]})})]})]})]})]})})}const Q=[{label:"Gathering player data...",icon:"ðŸ“Š"},{label:"Analyzing matchups...",icon:"âš”ï¸"},{label:"Evaluating defenses...",icon:"ðŸ›¡ï¸"},{label:"AI generating insights...",icon:"ðŸ¤–"},{label:"Finalizing recommendations...",icon:"âœ¨"}];function Xe({totalPlayers:s,completedPlayers:a}){const[r,h]=n.useState(0),i=s>0?a/s*100:0;n.useEffect(()=>{const y=Math.floor(i/100*Q.length);h(Math.min(y,Q.length-1))},[i]);const c=i,S=Math.sin(i/100*Math.PI)*30;return e.jsxs("div",{className:"w-full py-8 px-6 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20 rounded-lg border border-green-200 dark:border-green-800",children:[e.jsxs("div",{className:"relative w-full h-32 mb-6 bg-gradient-to-b from-green-600 to-green-700 rounded-lg overflow-hidden shadow-inner",children:[[0,20,40,60,80,100].map(y=>e.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-white/30",style:{left:`${y}%`}},y)),e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-[10%] bg-blue-600/40"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-[10%] bg-red-600/40"}),e.jsx("div",{className:"absolute transition-all duration-300 ease-out",style:{left:`${c}%`,bottom:`${50+S}%`,transform:`translateX(-50%) rotate(${c*3.6}deg)`},children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-4xl animate-bounce",style:{animationDuration:"0.6s"},children:"ðŸˆ"}),i>0&&e.jsxs("div",{className:"absolute top-1/2 -right-8 flex gap-1",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-white/40 animate-pulse"}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-white/30 animate-pulse",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-white/20 animate-pulse",style:{animationDelay:"0.2s"}})]})]})}),e.jsx("div",{className:"absolute left-[5%] top-1/2 -translate-y-1/2 text-2xl",children:"ðŸ"}),e.jsx("div",{className:"absolute right-[5%] top-1/2 -translate-y-1/2 text-2xl",children:"ðŸŽ¯"})]}),e.jsx("div",{className:"relative w-full h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mb-4 shadow-inner",children:e.jsx("div",{className:"absolute top-0 left-0 h-full bg-gradient-to-r from-blue-500 via-green-500 to-emerald-500 transition-all duration-500 ease-out rounded-full shadow-lg",style:{width:`${i}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"})})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl animate-pulse",children:Q[r].icon}),e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:Q[r].label})]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Analyzing ",a," of ",s," players (",Math.round(i),"%)"]})]}),e.jsx("div",{className:"flex justify-center gap-2 mt-4",children:Q.map((y,w)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-all duration-300 ${w<=r?"bg-green-600 dark:bg-green-400 scale-110":"bg-gray-300 dark:bg-gray-600"}`,title:y.label},w))})]})}const Ze={"A+":"bg-green-600",A:"bg-green-500",B:"bg-blue-500",C:"bg-yellow-500",D:"bg-orange-500",F:"bg-red-500"},Qe={START:"bg-green-600",CONSIDER:"bg-yellow-600",SIT:"bg-red-600"};function Ve({matchupId:s}){var W,O,H;const[a,r]=n.useState(null),[h,i]=n.useState(!0),[c,S]=n.useState(!1),[y,w]=n.useState(""),[f,x]=n.useState(null);n.useEffect(()=>{b()},[s]);const b=async()=>{try{i(!0);const m=await xe(s);r(m.data)}catch(m){w("Failed to load matchup"),console.error(m)}finally{i(!1)}},C=async()=>{try{S(!0),w(""),await Ee(s),await b(),l()}catch(m){w("Failed to analyze matchup"),console.error(m),S(!1)}},l=()=>{const m=setInterval(async()=>{var T;try{const F=(await xe(s)).data,z=(T=F.analysis)==null?void 0:T.every(I=>I.analysis_status==="completed"||I.analysis_status==="failed");r(F),z&&(clearInterval(m),S(!1))}catch(R){console.error("Polling error:",R),clearInterval(m),S(!1)}},3e3);setTimeout(()=>{clearInterval(m),S(!1)},3e5)};if(h)return e.jsx(N,{children:e.jsx(v,{className:"py-8",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Loading matchup..."})})});if(!a)return e.jsx(N,{children:e.jsx(v,{className:"py-8",children:e.jsx("p",{className:"text-center text-red-600",children:"Matchup not found"})})});const g=((W=a.analysis)==null?void 0:W.filter(m=>m.is_user_player))||[],E=g.filter(m=>m.recommendation==="START"),D=g.filter(m=>m.recommendation==="SIT"),Z=g.filter(m=>m.recommendation==="CONSIDER"),Y=((O=a.analysis)==null?void 0:O.some(m=>m.analysis_status==="analyzing"||m.reasoning==="Generating AI analysis..."))||!1;console.log("Debug - analyzing:",c),console.log("Debug - hasAnalysisInProgress:",Y),console.log("Debug - matchup.analysis:",(H=a.analysis)==null?void 0:H.map(m=>({name:m.player_name,status:m.analysis_status,reasoning:m.reasoning})));const B=g.length>0?(g.reduce((m,T)=>m+T.projected_points,0)/g.length).toFixed(2):"0";return e.jsxs("div",{className:"space-y-6",children:[e.jsx(N,{children:e.jsx(L,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(P,{children:["Week ",a.week," Analysis - ",a.season]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[a.user_roster_name," vs Real NFL Defenses"]})]}),e.jsx(p,{onClick:C,disabled:c,className:"min-w-32",children:c?"Analyzing...":a.analyzed?"Re-analyze":"Analyze"})]})})}),y&&e.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-950 text-red-600 dark:text-red-400 rounded-md text-sm",children:y}),(c||Y)&&a.analysis&&a.analysis.length>0&&e.jsx(Xe,{totalPlayers:a.analysis.length,completedPlayers:a.analysis.filter(m=>m.analysis_status==="completed"||m.analysis_status==="failed").length}),a.analyzed&&a.analysis&&a.analysis.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(N,{children:e.jsxs(v,{className:"pt-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Projected"}),e.jsxs("p",{className:"text-2xl font-bold",children:[B," pts"]})]})}),e.jsx(N,{children:e.jsxs(v,{className:"pt-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Should Start"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:E.length})]})}),e.jsx(N,{children:e.jsxs(v,{className:"pt-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Monitor"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:Z.length})]})}),e.jsx(N,{children:e.jsxs(v,{className:"pt-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Should Sit"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:D.length})]})})]}),e.jsxs(N,{children:[e.jsx(L,{children:e.jsx(P,{children:"Your Players - Start/Sit Recommendations"})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-4",children:g.map(m=>e.jsx(qe,{analysis:m,onPlayerClick:(T,R)=>x({id:T,name:R})},m.id))})})]})]}),!a.analyzed&&e.jsx(N,{children:e.jsx(v,{className:"py-12",children:e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx("p",{className:"text-lg mb-2",children:"No analysis yet"}),e.jsx("p",{className:"text-sm",children:'Click "Analyze" to generate start/sit recommendations'})]})})}),f&&e.jsx(Ke,{playerId:f.id,playerName:f.name,onClose:()=>x(null)})]})}function qe({analysis:s,onPlayerClick:a}){const r=Ze[s.ai_grade]||"bg-gray-500",h=Qe[s.recommendation]||"bg-gray-500",i=s.analysis_status==="analyzing"||s.reasoning==="Generating AI analysis...",c=s.analysis_status==="failed";return e.jsxs("div",{className:"border rounded-lg p-4 relative",children:[i&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-blue-500 border-t-transparent rounded-full"})}),e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.team&&e.jsx("img",{src:X(s.team),alt:s.team,className:"w-6 h-6 object-contain",onError:S=>S.currentTarget.style.display="none"}),e.jsx("h3",{className:"font-semibold text-lg cursor-pointer hover:text-blue-600 transition-colors",onClick:()=>a(s.player_id,s.player_name),children:s.player_name}),e.jsx(k,{variant:"outline",children:s.position}),e.jsx(k,{variant:"outline",children:s.team}),s.injury_status&&s.injury_status!=="HEALTHY"&&e.jsx(k,{className:"bg-orange-500 text-white",children:s.injury_status})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{className:`${r} text-white`,children:s.ai_grade}),e.jsx(k,{className:`${h} text-white`,children:s.recommendation})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Matchup Score"}),e.jsx("p",{className:"text-lg font-semibold",children:s.matchup_score.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Projected Points"}),e.jsx("p",{className:"text-lg font-semibold",children:s.projected_points.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Confidence"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.confidence_score.toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"AI Analysis:"}),i?e.jsx("div",{className:"flex items-center gap-2 text-blue-600",children:e.jsx("div",{className:"animate-pulse",children:"Generating AI analysis..."})}):c?e.jsx("p",{className:"text-red-600",children:"Failed to generate AI analysis"}):e.jsx("p",{children:s.reasoning})]}),s.injury_impact&&s.injury_impact!=="No impact"&&e.jsxs("div",{className:"mt-2 p-2 bg-orange-50 dark:bg-orange-950 rounded text-sm",children:[e.jsx("span",{className:"font-medium",children:"Injury Impact:"})," ",s.injury_impact]})]})}function Je({rosterId:s}){const[a,r]=n.useState(null),[h,i]=n.useState(!0),[c,S]=n.useState("");n.useEffect(()=>{y()},[s]);const y=async()=>{try{i(!0);const f=await Le(s);r(f.data)}catch(f){S("Failed to load season matchups"),console.error(f)}finally{i(!1)}};if(h)return e.jsx(N,{children:e.jsx(v,{className:"py-8",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Loading season matchups..."})})});if(c||!a)return e.jsx(N,{children:e.jsx(v,{className:"py-8",children:e.jsx("p",{className:"text-center text-red-600",children:c||"No data available"})})});const w=Object.keys(a.matchups).map(Number).sort((f,x)=>f-x);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(N,{children:e.jsxs(L,{children:[e.jsxs(P,{children:[a.roster_name," - ",a.season," Season Matchups"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.total_weeks," weeks available"]})]})}),e.jsx("div",{className:"space-y-4",children:w.map(f=>e.jsxs(N,{children:[e.jsx(L,{children:e.jsxs(P,{className:"text-lg",children:["Week ",f]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-2",children:a.matchups[f].map((x,b)=>e.jsx(es,{matchup:x},b))})})]},f))})]})}function es({matchup:s}){const a=s.player,r=!s.has_game||s.opponent_team===null;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:te(a.player_id),alt:a.player_name,className:"w-10 h-10 rounded-full object-cover border border-gray-200 dark:border-gray-700",onError:h=>{h.currentTarget.src="https://a.espncdn.com/combiner/i?img=/i/headshots/nophoto.png&w=200&h=146"}}),a.team&&e.jsx("img",{src:X(a.team),alt:a.team,className:"w-6 h-6 object-contain",onError:h=>h.currentTarget.style.display="none"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.player_name}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(k,{variant:"outline",children:a.position}),e.jsx(k,{variant:"outline",children:a.team})]})]})]}),e.jsx("div",{className:"text-right",children:r?e.jsx(k,{className:"bg-gray-500 text-white",children:"BYE"}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"vs"}),s.opponent_team&&e.jsx("img",{src:X(s.opponent_team),alt:s.opponent_team,className:"w-6 h-6 object-contain",onError:h=>h.currentTarget.style.display="none"}),e.jsx(k,{className:"bg-blue-600 text-white",children:s.opponent_team})]})})]})}function ls(){const[s,a]=n.useState([]),[r,h]=n.useState(null),[i,c]=n.useState(null),[S,y]=n.useState([]),[w,f]=n.useState("rosters"),[x,b]=n.useState(!1),[C,l]=n.useState(!1),[g,E]=n.useState(!1),[D,Z]=n.useState([]),[Y,B]=n.useState(!1),[W,O]=n.useState(null),[H,m]=n.useState(!0),[T,R]=n.useState(""),[F,z]=n.useState(""),[I,d]=n.useState(""),[u,o]=n.useState("PPR"),[j,A]=n.useState(1),[U,ne]=n.useState(2025),[ae,ue]=n.useState(null),[G,ge]=n.useState([]);n.useEffect(()=>{V(),ce(),je()},[]);const je=async()=>{try{const t=await Pe();t.data&&(A(t.data.week),ne(t.data.season),ie(t.data.season))}catch(t){console.error("Failed to load current week:",t)}},ie=async t=>{try{const _=await Te(t);_.data&&ge(_.data.available_weeks)}catch(_){console.error("Failed to load available weeks:",_)}},V=async()=>{try{m(!0);const t=await Fe();a(t.data||[]),t.data&&t.data.length>0&&!r&&h(t.data[0].id)}catch(t){R("Failed to load rosters"),console.error(t)}finally{m(!1)}},ce=async()=>{try{const t=await Me();y(t.data||[])}catch(t){console.error("Failed to load matchups:",t)}},pe=async t=>{if(t.preventDefault(),!!F)try{await De({name:F,league_name:I,scoring_type:u}),z(""),d(""),b(!1),await V()}catch(_){R("Failed to create roster"),console.error(_)}},fe=async t=>{if(confirm("Are you sure you want to delete this roster?"))try{await ze(t),r===t&&h(null),await V()}catch(_){R("Failed to delete roster"),console.error(_)}},be=async t=>{var _,M;if(t.preventDefault(),!ae){R("Please select a roster");return}if(G.length>0&&!G.includes(j)){R(`Schedule not available for Week ${j} yet. Please select a different week.`);return}try{const $=await We({week:j,season:U,user_roster_id:ae});l(!1),c($.data.id),f("matchup"),await ce()}catch($){const q=((M=(_=$.response)==null?void 0:_.data)==null?void 0:M.error)||"Failed to create matchup";R(q),console.error($)}},Ne=async()=>{var t,_,M,$,q;B(!0),E(!0);try{const K=await Ie();if(K.needs_auth||(t=K.data)!=null&&t.needs_auth){const re=localStorage.getItem("auth_token");window.location.href=`/api/yahoo/auth?token=${re}`;return}Z(((_=K.data)==null?void 0:_.leagues)||[])}catch(K){if((M=K.response)!=null&&M.needs_auth||(q=($=K.response)==null?void 0:$.data)!=null&&q.needs_auth){const re=localStorage.getItem("auth_token");window.location.href=`/api/yahoo/auth?token=${re}`}else R("Failed to load Yahoo leagues"),E(!1)}finally{B(!1)}},ye=async(t,_)=>{O(t);try{const M=await Oe({team_key:t,roster_name:_});E(!1),await V(),alert(`Successfully imported ${M.data.matched_players} players!`)}catch(M){R("Failed to import roster"),console.error(M)}finally{O(null)}};return e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2",children:"Roster Management"}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:"Build your roster and analyze weekly matchups"})]}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx(p,{variant:w==="rosters"?"default":"outline",onClick:()=>f("rosters"),children:"My Rosters"}),e.jsx(p,{variant:w==="matchup"?"default":"outline",onClick:()=>f("matchup"),children:"Weekly Matchup"}),e.jsx(p,{variant:w==="season"?"default":"outline",onClick:()=>f("season"),disabled:!r,children:"Season Matchups"})]}),T&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-950 text-red-600 dark:text-red-400 rounded-md text-sm",children:[T,e.jsx("button",{onClick:()=>R(""),className:"ml-2 underline",children:"Dismiss"})]}),w==="rosters"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(N,{children:[e.jsx(L,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(P,{children:"My Rosters"}),e.jsx(p,{size:"sm",onClick:()=>b(!0),children:"+ New"})]})}),e.jsx(v,{children:H?e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."}):s.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No rosters yet"}),e.jsx(p,{onClick:()=>b(!0),children:"Create Your First Roster"})]}):e.jsx("div",{className:"space-y-2",children:s.map(t=>e.jsx("div",{className:`p-3 border rounded-md cursor-pointer hover:bg-accent ${r===t.id?"bg-accent":""}`,onClick:()=>h(t.id),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:t.name}),t.league_name&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t.league_name}),e.jsx(k,{variant:"outline",className:"text-xs mt-1",children:t.scoring_type})]}),e.jsx(p,{size:"sm",variant:"ghost",onClick:_=>{_.stopPropagation(),fe(t.id)},children:"ðŸ—‘ï¸"})]})},t.id))})})]})}),e.jsx("div",{className:"lg:col-span-2",children:r?e.jsx(Ge,{rosterId:r},r):e.jsx(N,{children:e.jsx(v,{className:"py-12",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Select a roster to view"})})})})]}),w==="matchup"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Weekly Matchups"}),e.jsx(p,{onClick:()=>l(!0),children:"+ New Matchup"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:S.map(t=>e.jsx(N,{className:`cursor-pointer hover:bg-accent ${i===t.id?"ring-2 ring-primary":""}`,onClick:()=>c(t.id),children:e.jsx(v,{className:"pt-6",children:e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Week ",t.week," â€¢ ",t.season]}),e.jsx("p",{className:"font-semibold",children:t.user_roster_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"vs NFL Defenses"})]}),t.analyzed&&e.jsx(k,{className:"bg-green-600 text-white",children:"Analyzed"})]})})},t.id))}),i?e.jsx(Ve,{matchupId:i}):e.jsx(N,{children:e.jsx(v,{className:"py-12",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Select a matchup or create a new one to analyze"})})})]}),w==="season"&&r&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Season Matchups"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View all future matchups for the selected roster"})]}),e.jsx(Je,{rosterId:r})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(N,{className:"max-w-md w-full mx-4",children:[e.jsx(L,{children:e.jsx(P,{children:"Create New Roster"})}),e.jsxs(v,{children:[e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-3",children:"Quick Setup Options"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{type:"button",variant:"outline",className:"w-full justify-start bg-white dark:bg-gray-900",onClick:()=>{b(!1),Ne()},children:[e.jsx("span",{className:"text-purple-600 mr-2",children:"ðŸ“±"}),"Import from Yahoo Fantasy"]}),e.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300 ml-6",children:"Instantly import your existing Yahoo roster with all players"})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-4",children:"Or create manually:"}),e.jsxs("form",{onSubmit:pe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium",children:["Roster Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{value:F,onChange:t=>z(t.target.value),placeholder:"e.g., My Fantasy Team",required:!0,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"League Name (Optional)"}),e.jsx(J,{value:I,onChange:t=>d(t.target.value),placeholder:"e.g., Friends League",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Scoring Type"}),e.jsxs("select",{value:u,onChange:t=>o(t.target.value),className:"w-full mt-1 px-3 py-2 border rounded-md",children:[e.jsx("option",{value:"PPR",children:"PPR (Point Per Reception)"}),e.jsx("option",{value:"HALF_PPR",children:"Half PPR"}),e.jsx("option",{value:"STANDARD",children:"Standard"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{type:"submit",className:"flex-1",children:"Create Empty Roster"}),e.jsx(p,{type:"button",variant:"outline",onClick:()=>b(!1),className:"flex-1",children:"Cancel"})]})]})]})]})]})}),C&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(N,{className:"max-w-md w-full mx-4",children:[e.jsx(L,{children:e.jsx(P,{children:"Create New Matchup"})}),e.jsx(v,{children:e.jsxs("form",{onSubmit:be,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Week"}),e.jsx(J,{type:"number",min:"1",max:"18",value:j,onChange:t=>A(parseInt(t.target.value)),className:"mt-1"}),G.length>0&&!G.includes(j)&&e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"Schedule not available for this week yet"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Season"}),e.jsx(J,{type:"number",min:"2020",max:"2030",value:U,onChange:t=>{const _=parseInt(t.target.value);ne(_),ie(_)},className:"mt-1"})]})]}),G.length>0&&e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-950 rounded-md text-sm",children:e.jsxs("p",{className:"font-medium text-blue-900 dark:text-blue-100",children:["Available weeks: ",G.join(", ")]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium",children:["Select Roster ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:ae||"",onChange:t=>ue(parseInt(t.target.value)),required:!0,className:"w-full mt-1 px-3 py-2 border rounded-md",children:[e.jsx("option",{value:"",children:"Select roster..."}),s.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{type:"submit",className:"flex-1",children:"Create"}),e.jsx(p,{type:"button",variant:"outline",onClick:()=>l(!1),className:"flex-1",children:"Cancel"})]})]})})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(N,{className:"max-w-2xl w-full mx-4 max-h-[80vh] overflow-auto",children:[e.jsx(L,{children:e.jsx(P,{children:"Select Yahoo Fantasy League"})}),e.jsx(v,{children:Y?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading your leagues..."})}):D.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground",children:"No leagues found"}),e.jsx(p,{variant:"outline",onClick:()=>E(!1),className:"mt-4",children:"Close"})]}):e.jsxs("div",{className:"space-y-3",children:[D.map(t=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-accent cursor-pointer",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:t.team_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.league_name}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[t.num_teams," teams"]})]}),e.jsx(p,{size:"sm",onClick:()=>ye(t.team_key,t.team_name),disabled:W===t.team_key,children:W===t.team_key?"Importing...":"Import"})]})},t.team_key)),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(p,{variant:"outline",onClick:()=>E(!1),children:"Cancel"})})]})})]})})]})}export{ls as RosterManagement};
